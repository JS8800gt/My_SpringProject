<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
    <!-- Noto Sans KR -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+KR:wght@400;500;700&display=swap" rel="stylesheet">
    <!-- css -->
    <link rel="stylesheet" href="/member/css/member.css">
    <link rel="stylesheet" href="/main/css/header.css">
    <link rel="stylesheet" href="/main/css/footer.css">
    <!-- icon -->
    <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Material+Symbols+Outlined:opsz,wght,FILL,GRAD@20..48,100..700,0..1,-50..200" />
</head>
<style>
    .material-symbols-outlined {
      font-variation-settings:
      'FILL' 0,
      'wght' 200,
      'GRAD' 0,
      'opsz' 48
    }
    .fill{
        color: #ff4500 !important;
      font-variation-settings:
      'FILL' 1,
      'wght' 200,
      'GRAD' 0,
      'opsz' 48
    }
</style>
<body>
    <header th:replace="main/header.html" :: h></header>
    <main class="signup_main">
        <h2>회원가입</h2>
        <section>
            <div class="main_start">
                <span class="essential">* </span>필수입력사항
            </div>
            <form name="joinForm" method="POST">
                <div class="main_section">
                    <div class="label_div">
                        <label>아이디<span class="essential">*</span></label>
                    </div>
                    <div class="input_section">
                        <input class="input_box" type="text" placeholder="아이디를 입력해주세요">
                    </div>
                    <div class="button_section">
                        <button>중복확인</button>
                    </div>
                </div>
                <div class="main_section">
                    <div class="label_div">
                        <label>비밀번호<span class="essential">*</span></label>
                    </div>
                    <div class="input_section">
                        <input class="input_box" type="password" id="memberPw" placeholder="비밀번호를 입력해주세요">
                        <div class="msg">
                            <p id="checkPw_msg"></p>
                        </div>
                    </div>
                    <div class="button_section"></div>
                </div>
                <div class="main_section">
                    <div class="label_div">
                        <label>비밀번호확인<span class="essential">*</span></label>
                    </div>
                    <div class="input_section">
                        <input class="input_box" type="password" id="memberPwCheck" placeholder="비밀번호를 한번 더 입력해주세요">
                        <div class="msg">
                            <p id="checkPwOk_msg"></p>
                        </div>
                    </div>
                    <div class="button_section"></div>
                </div>
                <dåiv class="main_section">
                    <div class="label_div">
                        <label>이름<span class="essential">*</span></label>
                    </div>
                    <div class="input_section">
                        <input class="input_box" type="text" placeholder="이름을 입력해 주세요">
                    </div>
                    <div class="button_section"></div>
                </dåiv>
                <div class="main_section">
                    <div class="label_div">
                        <label>이메일<span class="essential">*</span></label>
                    </div>
                    <div class="input_section">
                        <input class="input_box" type="email" id="email" placeholder="예: marketkurly@kurly.com">
                        <div class="msg">
                            <p id="checkEmail_msg"></p>
                        </div>
                    </div>
                    <div class="button_section">
                        <button>중복확인</button>
                    </div>
                </div>
                <div class="main_section">
                    <div class="label_div">
                        <label>휴대폰<span class="essential">*</span></label>
                    </div>
                    <div class="input_section">
                        <input class="input_box" id="memberPhoneNumber" maxlength="11" type="text" oninput="this.value = this.value.replace(/[^0-9.]/g, '').replace(/(\..*)\./g, '$1');" placeholder="숫자만 입력해주세요." autocomplete="off">
                    </div>
                    <div class="button_section">
                        <button type="button" class="phone_check_button disabled_button">인증번호 받기</button>
                    </div>
                </div>
                <div class="main_section num_check_input" >
                    <div class="label_div"></div>
                    <div class="input_section">
                        <input class="input_box" id="phoneNumCheck" maxlength="6" type="text" oninput="this.value = this.value.replace(/[^0-9.]/g, '').replace(/(\..*)\./g, '$1');" placeholder="인증번호를 입력해주세요." autocomplete="off">
                    </div>
                    <div class="button_section" style="position: relative">
                        <button type="button" class="disabled_button num_check_button">확인</button>
                        <span class="timer">
                            <span class="timer2" id="timer"></span>
                        </span>
                    </div>
                </div>
                <div class="main_section">
                    <div class="label_div">
                        <label>주소<span class="essential">*</span></label>
                    </div>
                    <div class="input_section">
                        <button class="address_search">
                            <span><img src="/main/images/main/search.png">주소 검색</span>
                        </button>
                        <span class="address_text">배송지에 따라 상품 정보가 달라질 수 있습니다.</span>
                    </div>
                    <div class="button_section"></div>
                </div>
                <div class="main_section">
                    <div class="label_div">
                        <label>성별</label>
                    </div>
                    <div class="input_section">
                        <div class="input_radio">
                            <label>
                                <input type="radio" name="gender" value="남자">
                                <span class="radio_circle"><span class="radio_in_circle"></span></span>
                                <span class="real_label">남자</span>
                            </label>
                            <label>
                                <input type="radio" name="gender" value="여자">
                                <span class="radio_circle"><span class="radio_in_circle"></span></span>
                                <span class="real_label">여자</span>
                            </label>
                            <label>
                                <input type="radio" name="gender" value="선택안함" checked>
                                <span class="radio_circle input_choice"><span class="radio_in_circle"></span></span>
                                <span class="real_label">선택안함</span>
                            </label>
                        </div>
                    </div>
                    <div class="button_section"></div>
                </div>
                <div class="main_section">
                    <div class="label_div"><label>생년월일</label></div>
                    <div class="input_section">
                        <div class="birth_box">
                            <div><input type="text" placeholder="YYYY"></div>
                            <span></span>
                            <div><input type="text" placeholder="MM">  </div>
                            <span></span>
                            <div><input type="text" placeholder="DD"></div>
                        </div>
                        <div class="msg">
                            <p id="checkBirth_msg"></p>
                        </div>
                    </div>
                    <div class="button_section"></div>
                </div>
            </form>
            <div class="input_last"></div>
            <div class="agree_section">
                <div class="agree_title">
                    <label>이용약관동의<span class="essential">*</span></label>
                </div>
                <div class="input_section">
                    <div class="agree_content">
                        <label class="agree_all">
                            <input type="checkbox" id="agreeAll">
                            <span class="material-symbols-outlined check_img" style="font-size: 32px;">check_circle</span>
                            전체 동의 합니다.
                        </label>
                        <p>선택항목에 동의하지 않은 경우도 회원가입 및 일반적인 서비스를 이용할 수 있습니다.</p>
                    </div>
                    <div class="agree_content">
                        <div class="agree_box">
                            <label>
                                <input type="checkbox" class="agree">
                                <span class="material-symbols-outlined check_img" style="font-size: 32px;">check_circle</span>
                                이용약관 동의
                            </label>
                            <span>(필수)</span>
                        </div>
                        <a>약관보기<i class="fa-solid fa-chevron-right"></i></a>
                    </div>
                    <div class="agree_content">
                        <div class="agree_box">
                            <label>
                                <input type="checkbox" class="agree">
                                <span class="material-symbols-outlined check_img" style="font-size: 32px;">check_circle</span>
                                개인정보 수집·이용 동의
                            </label>
                            <span>(필수)</span>
                        </div>
                        <a>약관보기<i class="fa-solid fa-chevron-right"></i></a>
                    </div>
                </div>
            </div>
            <div class="signup_submit">
                <button type="button">가입하기</button>
            </div>
        </section>
    </main>
    <footer th:replace="main/footer.html" :: f></footer>
</body>
</html>
<script src="https://kit.fontawesome.com/60492e1060.js" crossorigin="anonymous"></script>
<script src="https://code.jquery.com/jquery-3.6.1.min.js"></script>
<script src="/member/js/join.js"></script>
<script>
    var $phone_check_button = $("button.phone_check_button");
    var $memberPhoneNumber = $("input#memberPhoneNumber");
    var $num_check_button = $("button.num_check_button");
    var $phoneNumCheck = $("input#phoneNumCheck");
    var x;

    $memberPhoneNumber.on("keyup", function(){
        keyupCheck($memberPhoneNumber, $phone_check_button);
    });

    $phoneNumCheck.on("keyup", function(){
        keyupCheck($phoneNumCheck, $num_check_button);
    });

    $num_check_button.on("click", function(){
        clearInterval(x);
        let check = true;

        if(check){
            // 만약에 인증번호가 일치한다면 수정 불가능
            document.getElementById("timer").innerHTML = "";

            // 인증번호 버튼, 입력버튼 비활성화
            buttonDisable($(this));
            inputDisable($phoneNumCheck);
        } else {
            // 다시 인증번호 받기
        }
    });

    // 번호 인증 버튼을 누를 경우
    $phone_check_button.on("click", function(){
        <!-- 카운트다운 타이머 -->
        let time = 5; //기준시간설정
        let min = ""; //분
        let sec = ""; //초

        //setInterval(함수, 시간) : 주기적인 실행
        x = setInterval(function(){
            //parseInt : 정수 반환
            min = parseInt(time/60) /* 몫계산 */
            sec = time%60; //나머지 계산

            document.getElementById("timer").innerHTML = min + "분" + sec + "초";
            time--;

            //시간 끝나면
            if(time < 0) {
                clearInterval(x); //setInterval() 실행을 끝냄

                // 번호 입력을 다시 받기.
                $memberPhoneNumber.prop("placeholder", "다시 입력해주세요.");
                $memberPhoneNumber.val("");

                // 번호 입력창 활성화
                inputAble($memberPhoneNumber);

                // 인증번호 입력칸 감추기
                $('div.num_check_input').css("display", "none");

                $phoneNumCheck.val("");
            }
        }, 1000);

        // 인증번호 입력칸 보이게 하기
        $('div.num_check_input').css("display", "inline-flex");
            // 인증번호 입력창, 버튼 활성화
            inputDisable($memberPhoneNumber);
            buttonDisable($(this));
    });

    // 번호 및 인증번호 길이에 맞게 입력시 버튼 활성화
    function keyupCheck(input, btn){
        let length = input.val().length;
        let checkLength = input.attr("maxlength");

        if(length == checkLength){
            buttonAble(btn);
        }
    }

    // 버튼 활성화
    function buttonAble(btn){
        btn.removeClass("disabled_button");
        btn.attr("disabled", false);
    }

    // 버튼 비활성화
    function buttonDisable(btn){
        btn.addClass("disabled_button");
        btn.attr("disabled", true);
    }

    // 입력창 비활성화
    function inputDisable(input){
        input.attr("readonly", true);
        input.css("color", "rgb(221, 221, 221)");
    }

    // 입력창 활성화
    function inputAble(input){
        input.prop("readonly", false);
        input.css("color", "black");
    }

</script>
<script src="/main/js/header.js"></script>
